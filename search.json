[
  {
    "objectID": "R/mcmcglmm.html",
    "href": "R/mcmcglmm.html",
    "title": "The Interplay of Floral Rewards and Floral Symmetry Shapes Diversification Dynamics in an Amazonian Tree Family",
    "section": "",
    "text": "Figure 1 shows the phylogeny obtained from Vargas & Dick (2020) including 110 species of Lecythidoideae, and includes both information of trait states and speciation rates.\n\n\nCode\np0 &lt;- ggtree(CladsOutput$tree) %&lt;+% traits\n\np1 &lt;-\n    p0 +\n    geom_tippoint(aes(color = factor(state), size = lambda)) +\n    scale_color_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\")), label = c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")) +\n    labs(color = \"Trait State\", size = \"Speciation Rate\") +\n    theme(legend.position = c(0.2, 0.9))\n\ntraits2 &lt;- traits\ntraits2$species &lt;- factor(gsub(\"_\", \" \", traits2$species), levels = rev(gsub(\"_\", \" \", get_taxa_name(p0))))\n\np.lambda &lt;-\n    ggplot(traits2) +\n    geom_point(aes(x = lambda, y = species, colour = factor(state)), size = 2) +\n    geom_vline(xintercept = mean(traits2$lambda), linetype = \"dashed\", color = \"darkgrey\") +\n    scale_y_discrete(position = \"right\") +\n    scale_color_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\"))) +\n    labs(x = \"Speciation Rate\", y = \"Species\") +\n    cowplot::theme_cowplot() +\n    theme(axis.title.y = element_blank(),\n          axis.text.x = element_text(angle = 45, size = 10, hjust = 1),\n          axis.ticks.y = element_blank(),\n          axis.line.y = element_blank(),\n          legend.position = \"none\")\n\n(p1 | p.lambda) +\n    plot_layout(widths = c(0.5, 0.1))\n\n\n\n\n\n\n\n\nFigure 1: Phylogeny of Lecythidoideae displaying the distribution of trait states in the tips and speciation rates. The colors of the symbols at the tips describe the trait state, while both the icon size and the plot to the right show the distribution of speciation rates estimated using CLaDS.\n\n\n\n\n\n\n\nWe used the MuSSE model to estimate the state-dependent diversification rates(REF diversitree). We fitted the full model, including transitions that could be unlikely given the nature of our trait (q13 &lt;-&gt; q31). We decided to keep these transitions as free parameters since the sampling fraction in our phylogeny is rather low (0.474), and by freeing those parameters to be estimated we hope to capture some underlying double transitions that might have been detected if we were able to include more species in the analysis. We fitted this model in a Bayesian framework using the scripts available from  that was used in a similar context in previous studies (Burin et al. 2016). To ensure a good mixing of the MCMC, we set the sliding window parameters to one order of magnitude higher than the default values, and ran the chain for 2 million generations, sampling every 2000, resulting in a posterior distribution of 1000 samples. We checked for convergence by visual inspection (Figure 2) of trace plots and by ensuring the effective sample size was greater than 200 for most parameters.\n\n\nCode\nmusse.out &lt;- read.table(file = here(\"output/MuSSE/tree_lecy.tre_musse_mcmc.log\"), sep = \"\\t\", header = TRUE)\n#musse.out &lt;- read.table(\"./MuSSE_GB/tree_lecy.tre_musse_mcmc.log\", sep = \"\\t\", header = TRUE)\nmusse.out &lt;- musse.out[(floor(nrow(musse.out) * 0.1)):nrow(musse.out),]\n\nggplot(musse.out) +\n    geom_line(aes(x = Iteration, y = likelihood)) +\n    cowplot::theme_cowplot()\n\n\n\n\n\n\n\n\nFigure 2: Trace plot for the likelihood values of the Bayesian MuSSE analysis. It is possible to see that convergence was achieved given that the post-burnin values of likelihood vary around a central value.\n\n\n\n\n\nTable 1 shows the ESS values for the likelihood and for each parameter’s posterior distribution.\n\n\nCode\ness.musse &lt;- data.frame(Parameter = c(\"likelihood\",\n                                      paste0(\"lambda\", 1:3),\n                                      paste0(\"mu\", 1:3),\n                                      \"q12\",\n                                      \"q13\",\n                                      \"q21\",\n                                      \"q23\",\n                                      \"q31\",\n                                      \"q32\"),\n                        ESS = c(coda::effectiveSize(musse.out$likelihood),\n                                coda::effectiveSize(musse.out$lambda1),\n                                coda::effectiveSize(musse.out$lambda2),\n                                coda::effectiveSize(musse.out$lambda3),\n                                coda::effectiveSize(musse.out$mu1),\n                                coda::effectiveSize(musse.out$mu2),\n                                coda::effectiveSize(musse.out$mu3),\n                                coda::effectiveSize(musse.out$q12),\n                                coda::effectiveSize(musse.out$q13),\n                                coda::effectiveSize(musse.out$q21),\n                                coda::effectiveSize(musse.out$q23),\n                                coda::effectiveSize(musse.out$q31),\n                                coda::effectiveSize(musse.out$q32)\n                                )\n                        )\n\nknitr::kable(ess.musse)\n\n\n\n\nTable 1: ESS values for the global likelihood and each of the estimated parameters in MuSSE.\n\n\n\n\n\n\nParameter\nESS\n\n\n\n\nlikelihood\n901.0000\n\n\nlambda1\n262.1520\n\n\nlambda2\n415.2372\n\n\nlambda3\n962.2463\n\n\nmu1\n295.7000\n\n\nmu2\n411.3642\n\n\nmu3\n676.3563\n\n\nq12\n901.0000\n\n\nq13\n901.0000\n\n\nq21\n901.0000\n\n\nq23\n799.3535\n\n\nq31\n795.7985\n\n\nq32\n901.0000\n\n\n\n\n\n\n\n\n\n\n\n\nQuick note: state 0 for the MuSSE analyses in the manuscript correspond to state 3 here (Pollen + Polysymmetry)\n\nWe acknowledge that the selected MuSSE model can be seen as quite parameter-rich for the size of our phylogeny, rendering the parameter estimates questionable at best. To provide some more information to the discussion regarding rate differences between states we used generalized linear mixed models to test for differences in speciation rates at present between each of the three states. We used the speciation rates estimated at the tips of the phylogeny using CLaDS (REF), and grouped the species according to the three states of the composite trait. We set the sampling fraction to 0.43, and sampled 100 trees from the collection of trees derived from the data augmentation process.\nTo fit the mixed models to our data, we used the MCMCglmm package in R (REF), which implements generalized linear mixed models in a Bayesian framework that allows us to include different sources of uncertainty in parameter estimation. We ran the chains for 5 million generations, discarding the first 50% as burnin, and sampled every 2500 generations resulting in a posterior distribution of 1000 samples. We used inverse Wishart distributions as priors for the fixed and random effects, and assessed the effect size of each state by analysing the asymmetries of the posterior distributions in relation to zero (which would mean no effect).\n\n\nCode\n## setting up priors\n\nmy_priors &lt;- list(R = list(V = 1/2, nu = 0.002),\n                  G = list(G1 = list(V = 1/2, nu = 0.002)))\n\n## running the model\n\nmodel1 &lt;- MCMCglmm(fixed = rates ~ factor(state),\n                   random = ~ species,\n                   family = \"gaussian\",\n                   ginverse = list(species = inverseA(phytools::force.ultrametric(CladsOutput$tree, method = \"nnls\"))$Ainv),\n                   nitt = c(5000000),\n                   burnin = c(2500000),\n                   thin = c(2500),\n                   prior = my_priors,\n                   data = traits)\n\n## saving output\n\nsaveRDS(model1, file = here(\"output/mcmcglmm_results.RDS\"))"
  },
  {
    "objectID": "R/mcmcglmm.html#bayesian-musse-analysis",
    "href": "R/mcmcglmm.html#bayesian-musse-analysis",
    "title": "The Interplay of Floral Rewards and Floral Symmetry Shapes Diversification Dynamics in an Amazonian Tree Family",
    "section": "",
    "text": "We used the MuSSE model to estimate the state-dependent diversification rates(REF diversitree). We fitted the full model, including transitions that could be unlikely given the nature of our trait (q13 &lt;-&gt; q31). We decided to keep these transitions as free parameters since the sampling fraction in our phylogeny is rather low (0.474), and by freeing those parameters to be estimated we hope to capture some underlying double transitions that might have been detected if we were able to include more species in the analysis. We fitted this model in a Bayesian framework using the scripts available from  that was used in a similar context in previous studies (Burin et al. 2016). To ensure a good mixing of the MCMC, we set the sliding window parameters to one order of magnitude higher than the default values, and ran the chain for 2 million generations, sampling every 2000, resulting in a posterior distribution of 1000 samples. We checked for convergence by visual inspection (Figure 2) of trace plots and by ensuring the effective sample size was greater than 200 for most parameters.\n\n\nCode\nmusse.out &lt;- read.table(file = here(\"output/MuSSE/tree_lecy.tre_musse_mcmc.log\"), sep = \"\\t\", header = TRUE)\n#musse.out &lt;- read.table(\"./MuSSE_GB/tree_lecy.tre_musse_mcmc.log\", sep = \"\\t\", header = TRUE)\nmusse.out &lt;- musse.out[(floor(nrow(musse.out) * 0.1)):nrow(musse.out),]\n\nggplot(musse.out) +\n    geom_line(aes(x = Iteration, y = likelihood)) +\n    cowplot::theme_cowplot()\n\n\n\n\n\n\n\n\nFigure 2: Trace plot for the likelihood values of the Bayesian MuSSE analysis. It is possible to see that convergence was achieved given that the post-burnin values of likelihood vary around a central value.\n\n\n\n\n\nTable 1 shows the ESS values for the likelihood and for each parameter’s posterior distribution.\n\n\nCode\ness.musse &lt;- data.frame(Parameter = c(\"likelihood\",\n                                      paste0(\"lambda\", 1:3),\n                                      paste0(\"mu\", 1:3),\n                                      \"q12\",\n                                      \"q13\",\n                                      \"q21\",\n                                      \"q23\",\n                                      \"q31\",\n                                      \"q32\"),\n                        ESS = c(coda::effectiveSize(musse.out$likelihood),\n                                coda::effectiveSize(musse.out$lambda1),\n                                coda::effectiveSize(musse.out$lambda2),\n                                coda::effectiveSize(musse.out$lambda3),\n                                coda::effectiveSize(musse.out$mu1),\n                                coda::effectiveSize(musse.out$mu2),\n                                coda::effectiveSize(musse.out$mu3),\n                                coda::effectiveSize(musse.out$q12),\n                                coda::effectiveSize(musse.out$q13),\n                                coda::effectiveSize(musse.out$q21),\n                                coda::effectiveSize(musse.out$q23),\n                                coda::effectiveSize(musse.out$q31),\n                                coda::effectiveSize(musse.out$q32)\n                                )\n                        )\n\nknitr::kable(ess.musse)\n\n\n\n\nTable 1: ESS values for the global likelihood and each of the estimated parameters in MuSSE.\n\n\n\n\n\n\nParameter\nESS\n\n\n\n\nlikelihood\n901.0000\n\n\nlambda1\n262.1520\n\n\nlambda2\n415.2372\n\n\nlambda3\n962.2463\n\n\nmu1\n295.7000\n\n\nmu2\n411.3642\n\n\nmu3\n676.3563\n\n\nq12\n901.0000\n\n\nq13\n901.0000\n\n\nq21\n901.0000\n\n\nq23\n799.3535\n\n\nq31\n795.7985\n\n\nq32\n901.0000"
  },
  {
    "objectID": "R/mcmcglmm.html#generalized-linear-mixed-models",
    "href": "R/mcmcglmm.html#generalized-linear-mixed-models",
    "title": "The Interplay of Floral Rewards and Floral Symmetry Shapes Diversification Dynamics in an Amazonian Tree Family",
    "section": "",
    "text": "Quick note: state 0 for the MuSSE analyses in the manuscript correspond to state 3 here (Pollen + Polysymmetry)\n\nWe acknowledge that the selected MuSSE model can be seen as quite parameter-rich for the size of our phylogeny, rendering the parameter estimates questionable at best. To provide some more information to the discussion regarding rate differences between states we used generalized linear mixed models to test for differences in speciation rates at present between each of the three states. We used the speciation rates estimated at the tips of the phylogeny using CLaDS (REF), and grouped the species according to the three states of the composite trait. We set the sampling fraction to 0.43, and sampled 100 trees from the collection of trees derived from the data augmentation process.\nTo fit the mixed models to our data, we used the MCMCglmm package in R (REF), which implements generalized linear mixed models in a Bayesian framework that allows us to include different sources of uncertainty in parameter estimation. We ran the chains for 5 million generations, discarding the first 50% as burnin, and sampled every 2500 generations resulting in a posterior distribution of 1000 samples. We used inverse Wishart distributions as priors for the fixed and random effects, and assessed the effect size of each state by analysing the asymmetries of the posterior distributions in relation to zero (which would mean no effect).\n\n\nCode\n## setting up priors\n\nmy_priors &lt;- list(R = list(V = 1/2, nu = 0.002),\n                  G = list(G1 = list(V = 1/2, nu = 0.002)))\n\n## running the model\n\nmodel1 &lt;- MCMCglmm(fixed = rates ~ factor(state),\n                   random = ~ species,\n                   family = \"gaussian\",\n                   ginverse = list(species = inverseA(phytools::force.ultrametric(CladsOutput$tree, method = \"nnls\"))$Ainv),\n                   nitt = c(5000000),\n                   burnin = c(2500000),\n                   thin = c(2500),\n                   prior = my_priors,\n                   data = traits)\n\n## saving output\n\nsaveRDS(model1, file = here(\"output/mcmcglmm_results.RDS\"))"
  },
  {
    "objectID": "R/mcmcglmm.html#bayesian-musse-analysis-1",
    "href": "R/mcmcglmm.html#bayesian-musse-analysis-1",
    "title": "The Interplay of Floral Rewards and Floral Symmetry Shapes Diversification Dynamics in an Amazonian Tree Family",
    "section": "Bayesian MuSSE analysis",
    "text": "Bayesian MuSSE analysis\nThe posterior distribution of speciation, extinction and net diversification rates for each state of the trait are represented in Figure 3.\n\n\nCode\nmusse.plot.lambda &lt;- reshape2::melt(musse.out[, 6:8])\n\nplot.lambda &lt;-\n    ggplot(musse.plot.lambda, aes(x = value, y = variable, fill = variable, color = variable)) +\n    stat_slab(aes(thickness = after_stat(pdf * n)), scale = 0.7, alpha = 0.3) +\n    stat_dotsinterval(side = \"top\", scale = 0.4, slab_linewidth = NA, .width = c(0.83, 0.95)) +\n    scale_fill_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\", direction = 1)), labels = c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")) +\n    scale_color_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\", direction = 1)), labels = c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")) +\n    #geom_vline(xintercept = 0, linetype = \"dashed\", colour = \"darkgrey\") +\n    labs(x = \"Speciation Rate\", color = \"Trait Combination\", fill = \"Trait Combination\") +\n    cowplot::theme_cowplot(font_size = 30) +\n    theme(legend.position = \"none\",\n          legend.text = element_text(size = 20),\n          axis.text.y = element_blank(),\n          axis.title.y = element_blank(),\n          axis.ticks.y = element_blank(),\n          axis.line.y = element_blank())\n\nmusse.plot.mu &lt;- reshape2::melt(musse.out[, 9:11])\n\nplot.mu &lt;-\n    ggplot(musse.plot.mu, aes(x = value, y = variable, fill = variable, color = variable)) +\n    stat_slab(aes(thickness = after_stat(pdf * n)), scale = 0.7, alpha = 0.3) +\n    stat_dotsinterval(side = \"top\", scale = 0.4, slab_linewidth = NA, .width = c(0.83, 0.95)) +\n    scale_fill_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\", direction = 1)), labels = c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")) +\n    scale_color_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\", direction = 1)), labels = c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")) +\n    #geom_vline(xintercept = 0, linetype = \"dashed\", colour = \"darkgrey\") +\n    labs(x = \"Extinction Rate\", color = \"Trait Combination\", fill = \"Trait Combination\") +\n    cowplot::theme_cowplot(font_size = 30) +\n    theme(legend.position = \"none\",\n          legend.text = element_text(size = 20),\n          axis.text.y = element_blank(),\n          axis.title.y = element_blank(),\n          axis.ticks.y = element_blank(),\n          axis.line.y = element_blank())\n\n\nmusse.plot.r &lt;- reshape2::melt(musse.out[, 6:8] - musse.out[, 9:11])\n\nplot.r &lt;-\n    ggplot(musse.plot.r, aes(x = value, y = variable, fill = variable, color = variable)) +\n    stat_slab(aes(thickness = after_stat(pdf * n)), scale = 0.7, alpha = 0.3) +\n    stat_dotsinterval(side = \"top\", scale = 0.4, slab_linewidth = NA, .width = c(0.83, 0.95)) +\n    scale_fill_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\", direction = 1)), labels = c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")) +\n    scale_color_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\", direction = 1)), labels = c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")) +\n    #geom_vline(xintercept = 0, linetype = \"dashed\", colour = \"darkgrey\") +\n    labs(x = \"Net Diversification Rate\", color = \"Trait Combination\", fill = \"Trait Combination\") +\n    cowplot::theme_cowplot(font_size = 30) +\n    theme(legend.position = \"bottom\",\n          legend.justification = \"center\",\n          legend.text = element_text(size = 20),\n          axis.text.y = element_blank(),\n          axis.title.y = element_blank(),\n          axis.ticks.y = element_blank(),\n          axis.line.y = element_blank())\n\n\n(plot.lambda / plot.mu / plot.r) +\n    plot_annotation(tag_levels = \"A\")\n\n\n\n\n\n\n\n\nFigure 3: Posterior distribution of speciation (A), extinction (B), and net diversification (C) rates from MuSSE for each trait state. The dots represent the binned parameter values and their respective frequency, whereas the curve denotes the posterior probability density of parameter values. For each state, the dots, thick lines and thin lines represent, respectively, the median, the 83% and 95% credibility intervals.\n\n\n\n\n\nTo test for differences between the rates from each state, we generated posterior distributions of speciation (A), extinction (B) and net diversification (C) rate differences (Figure 4). To do that, we set one of the states as the reference (in this case “Pollen + Polysymmetry”), and calculated the differences between the estimated rates for this state in relation to the others (i.e. difference in rates between “Pollen + Polysymmetry” and “Nectar + Monosymmetry” and “Pollen + Polysymmetry” and “Pollen + Monosymmetry”). This way, positive values indicate that the reference state has higher rates than the other two states, and vice-versa.\n\n\nCode\nlambda.diff &lt;- musse.plot.lambda\nlambda.diff$diff &lt;- lambda.diff$value - rep(lambda.diff$value[lambda.diff$variable == \"lambda3\"], 3)\nlambda.diff &lt;- lambda.diff[1:1802,]\n\nlambda.diff.plot &lt;- \n    ggplot(lambda.diff, aes(x = diff, y = variable, fill = variable, color = variable)) +\n    stat_slab(aes(thickness = after_stat(pdf * n)), scale = 0.7, alpha = 0.3) +\n    stat_dotsinterval(side = \"top\", scale = 0.4, slab_linewidth = NA, .width = c(0.83, 0.95)) +\n    scale_fill_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\", direction = 1))[1:2], labels = c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")[1:2]) +\n    scale_color_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\", direction = 1))[1:2], labels = c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")[1:2]) +\n                                        #geom_vline(xintercept = 0, linetype = \"dashed\", colour = \"darkgrey\") +\n    labs(x = \"Speciation Rate Difference\", color = \"Trait Combination\", fill = \"Trait Combination\") +\n    xlim(-0.1, 0.4) +\n    geom_vline(xintercept = 0, linetype = \"dashed\", colour = \"lightgrey\", linewidth = 1.5) +\n    cowplot::theme_cowplot(font_size = 30) +\n    theme(legend.position = \"none\",\n          legend.justification = \"center\",\n          legend.text = element_text(size = 20),\n          axis.text.y = element_blank(),\n          axis.title.y = element_blank(),\n          axis.ticks.y = element_blank(),\n          axis.line.y = element_blank())\n\n\nmu.diff &lt;- musse.plot.mu\nmu.diff$diff &lt;- mu.diff$value - rep(mu.diff$value[mu.diff$variable == \"mu3\"], 3)\nmu.diff &lt;- mu.diff[1:1802,]\n\nmu.diff.plot &lt;- \n    ggplot(mu.diff, aes(x = diff, y = variable, fill = variable, color = variable)) +\n    stat_slab(aes(thickness = after_stat(pdf * n)), scale = 0.7, alpha = 0.3) +\n    stat_dotsinterval(side = \"top\", scale = 0.4, slab_linewidth = NA, .width = c(0.83, 0.95)) +\n    scale_fill_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\", direction = 1))[1:2], labels = c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")[1:2]) +\n    scale_color_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\", direction = 1))[1:2], labels = c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")[1:2]) +\n                                        #geom_vline(xintercept = 0, linetype = \"dashed\", colour = \"darkgrey\") +\n    labs(x = \"Extinction Rate Difference\", color = \"Trait Combination\", fill = \"Trait Combination\") +\n    xlim(-0.1, 0.4) +\n    geom_vline(xintercept = 0, linetype = \"dashed\", colour = \"lightgrey\", linewidth = 1.5) +\n    cowplot::theme_cowplot(font_size = 30) +\n    theme(legend.position = \"none\",\n          legend.justification = \"center\",\n          legend.text = element_text(size = 20),\n          axis.text.y = element_blank(),\n          axis.title.y = element_blank(),\n          axis.ticks.y = element_blank(),\n          axis.line.y = element_blank())\n\n\nnetdiv.diff &lt;- musse.plot.r\nnetdiv.diff$diff &lt;- netdiv.diff$value - rep(netdiv.diff$value[netdiv.diff$variable == \"lambda3\"], 3)\nnetdiv.diff &lt;- netdiv.diff[1:1802,]\n\nnetdiv.diff.plot &lt;- \n    ggplot(netdiv.diff, aes(x = diff, y = variable, fill = variable, color = variable)) +\n    stat_slab(aes(thickness = after_stat(pdf * n)), scale = 0.7, alpha = 0.3) +\n    stat_dotsinterval(side = \"top\", scale = 0.4, slab_linewidth = NA, .width = c(0.83, 0.95)) +\n    scale_fill_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\", direction = 1))[1:2], labels = c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")[1:2]) +\n    scale_color_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\", direction = 1))[1:2], labels = c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")[1:2]) +\n                                        #geom_vline(xintercept = 0, linetype = \"dashed\", colour = \"darkgrey\") +\n    labs(x = \"Net Diversification Rate Difference\", color = \"Trait Combination\", fill = \"Trait Combination\") +\n    xlim(-0.1, 0.4) +\n    geom_vline(xintercept = 0, linetype = \"dashed\", colour = \"lightgrey\", linewidth = 1.5) +\n    cowplot::theme_cowplot(font_size = 30) +\n    theme(legend.position = \"bottom\",\n          legend.justification = \"center\",\n          legend.text = element_text(size = 20),\n          axis.text.y = element_blank(),\n          axis.title.y = element_blank(),\n          axis.ticks.y = element_blank(),\n          axis.line.y = element_blank())\n\n(lambda.diff.plot / mu.diff.plot / netdiv.diff.plot) +\n    plot_annotation(tag_levels = \"A\")\n\n\n\n\n\n\n\n\nFigure 4: Median of posterior distribution of differences in speciation (A), extinction (B) and net diversification (C) rates from MuSSE for each trait state in relation to ‘Pollen + Polysymmetry’. The dots represent the binned parameter values and their respective frequency, whereas the curve denotes the posterior probability density of parameter values. For each state, the dots, thick lines and thin lines represent, respectively, the median, the 83% and 95% credibility intervals.\n\n\n\n\n\nLastly, the transition rates estimated from MuSSE are shown in Figure 5.\n\n\nCode\nmusse.plot.trans &lt;- reshape2::melt(musse.out[, 12:17])\n\ntrans.net &lt;- aggregate(musse.plot.trans$value, by = list(musse.plot.trans$variable), FUN = median)\nnames(trans.net) &lt;- c(\"node\", \"value\")\n\ntrans.mat &lt;- matrix(0, nrow = 3, ncol = 3)\ntrans.mat[upper.tri(trans.mat)] &lt;- trans.net$value[c(1, 2, 4)]\ntrans.mat[lower.tri(trans.mat)] &lt;- trans.net$value[c(3, 5, 6)]\ncolnames(trans.mat) &lt;- c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")\nrownames(trans.mat) &lt;- c(\"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\")\n\n\ncols &lt;- c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\", direction = 1))\narr.col &lt;- data.frame(c(\"Nectar + Monosymmetry\", \"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\", \"Pollen + Polysymmetry\"),\n                      c(\"Pollen + Monosymmetry\", \"Pollen + Polysymmetry\", \"Nectar + Monosymmetry\", \"Pollen + Polysymmetry\", \"Nectar + Monosymmetry\", \"Pollen + Monosymmetry\"),\n                      rep(cols, each = 2))\n\ncircos.par(gap.after = rep(20, 3))\nchordDiagram(trans.mat,\n             preAllocateTracks = list(grid.col = setNames(cols, rownames(trans.mat)),\n                                      track.height = max(strwidth(unlist(dimnames(trans.mat))))),\n             row.col = cols,\n             grid.col = setNames(cols, rownames(trans.mat)),\n             annotationTrack = c(\"grid\", \"axis\"),\n             annotationTrackHeight = c(0.05, 0.05),\n             order = rownames(trans.mat),\n             directional = 1,\n             direction.type = \"arrows\",\n             link.arr.col = arr.col,\n             link.arr.lwd = 3,\n             link.arr.length = 1.5,\n             transparency = 0.75\n             )\ncircos.track(track.index = 1, panel.fun = function(x, y) {\n    circos.text(CELL_META$xcenter, CELL_META$ylim[1], CELL_META$sector.index, \n        facing = \"bending.outside\", niceFacing = TRUE, adj = c(0.5, 1.2), cex = 3.5)\n}, bg.border = NA)\ncircos.clear()\n\n\n\n\n\n\n\n\nFigure 5: Median of posterior distribution of transition rates from MuSSE for each trait state. The bands describe the transition rates out of each state and towards the states indicated by the arrows, and the width of the bands denote the value of the rate. Crimson: Nectar + Monosymmetry; Green: Pollen + Monosymmetry; Blue: Pollen + Polysymmetry. It is important to note that the absolute values of transition rates are very low (in the order of 10-3)."
  },
  {
    "objectID": "R/mcmcglmm.html#generalized-linear-mixed-models-1",
    "href": "R/mcmcglmm.html#generalized-linear-mixed-models-1",
    "title": "The Interplay of Floral Rewards and Floral Symmetry Shapes Diversification Dynamics in an Amazonian Tree Family",
    "section": "Generalized Linear Mixed Models",
    "text": "Generalized Linear Mixed Models\nThe posterior distribution of parameter values indicate that species presenting the syndrome comprising “Pollen + Polysymmetry” have the highest speciation rates (Figure 6 bottom). The rates for those species are significantly different than the other two given that there is no overlap between the credibility intervals. For the other two states (namely “Pollen + Monosymmetry and Nectar + Monosymmetry”), the posterior distribution of parameter valuesshow a large overlap between each other, indicating that these two states do not differ in terms of speciation rates (Figure 6 top and middle). These results are congruent with the results obtained using MuSSE, which reinforces this pattern. However, it is important to note that the extinction rates obtained from MuSSE are much higher than the ones estimated from CLaDS (via \\(\\epsilon\\) - namely between 0.003 and 0.01 for CLaDS versus between 0.168 and 0.474 from MuSSE).\n\n\nCode\nmodel1 &lt;- readRDS(file = here(\"output/mcmcglmm_results.RDS\"))\n\nresult.table &lt;- as.data.frame(model1$Sol)\nnames(result.table) &lt;- c(\"Pollen + Polysymmetry\", \"Pollen + Monosymmetry\", \"Nectar + Monosymmetry\")\n\nresult.plot &lt;- reshape2::melt(result.table)\n\nggplot(result.plot, aes(y = variable, x = value, fill = variable)) +\n    stat_slab(aes(thickness = after_stat(pdf * n)), scale = 0.7, alpha = 0.3) +\n    stat_dotsinterval(side = \"top\", scale = 0.4, slab_linewidth = NA, .width = c(0.83, 0.95)) +\n    scale_fill_manual(values = c(met.brewer(\"Hokusai1\", n = 3, type = \"discrete\", direction = -1))) +\n    geom_vline(xintercept = 0, linetype = \"dashed\", colour = \"darkgrey\") +\n    labs(x = \"Slope\", y = \"Trait Combination\", fill = \"Trait Combination\") +\n    cowplot::theme_cowplot(font_size = 30) +\n    theme(legend.position = c(0.75, 0.8),\n          legend.text = element_text(size = 20),\n          axis.text.y = element_blank(),\n          axis.title.y = element_blank(),\n          axis.ticks.y = element_blank(),\n          axis.line.y = element_blank())\n\n\n\n\n\n\n\n\nFigure 6: Posterior distribution of parameters describing the relationship between speciation rates from CLaDS and trait state. The dots represent the binned parameter values and their respective frequency, whereas the curve denotes the posterior probability density of parameter values. For each state, the dots, thick lines and thin lines represent, respectively, the median, the 83% and 95% credibility intervals. The only state with significant effect is ‘Pollen + Polysymmetric’ (bottom distribution) since it is the only one that neither credibility intervals include 0."
  }
]